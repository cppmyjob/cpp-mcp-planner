<header class="header" data-testid="app-header">
  <div class="header__left">
    <p-button
      [icon]="'pi pi-bars'"
      [text]="true"
      [rounded]="true"
      severity="secondary"
      data-testid="sidebar-toggle"
      (onClick)="onSidebarToggle()"
    />
    <h1 class="header__title">MCP Planning Dashboard</h1>
  </div>

  <div class="header__center">
    <p-select
      [options]="projects()"
      [(ngModel)]="selectedProjectId"
      optionLabel="id"
      optionValue="id"
      [placeholder]="'Select Project'"
      [loading]="loadingProjects()"
      [filter]="true"
      filterBy="id"
      filterPlaceholder="Search projects..."
      [showClear]="true"
      (onChange)="onProjectChange($event.value)"
      [styleClass]="'project-selector'"
      data-testid="project-selector"
    />
    <p-select
      [options]="plans()"
      [(ngModel)]="selectedPlanId"
      optionLabel="name"
      optionValue="id"
      [placeholder]="'Select Plan'"
      [loading]="loadingPlans()"
      [filter]="true"
      filterBy="name"
      filterPlaceholder="Search plans..."
      [showClear]="true"
      (onChange)="onPlanChange($event.value)"
      [styleClass]="'plan-selector'"
      data-testid="plan-selector"
    />
  </div>

  <div class="header__right">
    <p-button
      icon="pi pi-plus"
      label="New Project"
      [text]="true"
      [rounded]="true"
      severity="secondary"
      data-testid="new-project-button"
      (onClick)="showProjectInitDialog()"
    />
    <p-button
      [icon]="isDarkTheme ? 'pi pi-sun' : 'pi pi-moon'"
      [text]="true"
      [rounded]="true"
      severity="secondary"
      data-testid="theme-toggle"
      (onClick)="toggleTheme()"
    />
  </div>
</header>

<app-project-init-dialog
  #projectInitDialog
  (projectCreated)="onProjectCreated($event)"
/>
